# @xionkq/md-to-pdf

Convert Markdown strings to text-searchable/selectable PDF (not screenshots), usable in browsers, implemented in TypeScript, compatible with Vue/React and other frontend projects.

**Note**: If you need to convert complex markdown, consider server-side implementations like [md-to-pdf](https://github.com/simonhaenisch/md-to-pdf); or convert to HTML first and use browser printing: [md2pdf](https://github.com/realdennis/md2pdf).

## Features

- One-click conversion from md format strings to PDF with download
- Uses GitHub markdown styles as theme
- Works in browser environments
- Supports element nesting
- Supports markdown and HTML syntax
- Supports Chinese fonts

## Online Demo (TODO)

[demo]().

## Quick Start

Install:

```bash
npm i @xionkq/md-to-pdf
```

Basic usage:

```ts
import { downloadPdf } from '@xionkq/md-to-pdf';

await downloadPdf('# Title\n\nContent', 'doc.pdf');
```

## Supported Tags and Syntax

### HTML Tags

#### Block Elements
- `<div>`, `<p>`, `<h1>` to `<h6>`
- `<table>`, `<thead>`, `<tbody>`, `<tfoot>`, `<tr>`, `<th>`, `<td>`
- `<ul>`, `<ol>`, `<li>`
- `<pre>`
- `<blockquote>`

#### Inline Elements
- `<span>`, `<strong>`, `<b>`, `<em>`, `<i>`, `<s>`
- `<a>` (with support for external and internal links)
- `<sub>`, `<sup>`
- `<img>`, `<svg>`
- `<br>`, `<hr>`
- `<code>`

### Markdown Syntax
- Same as above

## Unsupported Syntax

- Chinese italic text is not supported (NotoSansSC doesn't have italic fonts)

## Inline Styles Support

Support for using `style` attributes in HTML tags to set inline styles, which will be parsed and applied to PDF generation.

### Supported Tags

- `<div style="...">` - Block element styling
- `<p style="...">` - Paragraph styling  
- `<span style="...">` - Inline element styling
- `<strong style="...">`, `<em style="...">` - Formatted element styling

### Supported CSS Properties

#### Text Color
- `color: red` - CSS color names
- `color: #ff0000` - Hexadecimal
- `color: rgb(255, 0, 0)` - RGB format

#### Background Color
- `background-color: yellow`
- `background: #ffff00`

#### Font Styles
- `font-weight: bold` - Bold text
- `font-style: italic` - Italic text
- `text-decoration: underline` - Underline
- `text-decoration: line-through` - Strikethrough

#### Font Size (Experimental)
- `font-size: 12px` - Pixel values
- `font-size: 1.2em` - Relative sizes
- `font-size: 14pt` - Point values

### Color Format Support

Supports multiple CSS color formats:
- **Color Names**: `red`, `blue`, `green`, `orange` and 35+ standard colors
- **Hexadecimal**: `#ff0000`, `#f00` (3-digit and 6-digit)
- **RGB**: `rgb(255, 0, 0)`
- **RGBA**: `rgba(255, 0, 0, 0.5)` (alpha channel ignored)
- **HSL**: `hsl(0, 100%, 50%)`

## Configuration Options (TODO)

## Special Notes

### Using Images

Since pdfmake only supports base64 format for image nodes, your source markdown files should preferably use base64 format images, for example:

```markdown
<img src="data:image/jpeg;base64,/9j/4AAQ...">
or
[my image](data:image/jpeg;base64,/9j/4AAQ...)
```

You can also use URLs as image format, md-to-pdf will automatically convert them to base64, for example:

```markdown
<img src="https://example.com/image.jpg" alt="my image">
or
[my image](https://example.com/image.jpg)
```

However, when the image URL is not same-origin with your application, it will likely trigger CORS restrictions. In this case, you need to define an imageReserver function in your application to convert to base64 and pass it in the configuration, see examples (TODO); or adjust your server to allow cross-origin requests.

### Chinese Fonts

When Chinese characters are detected in the markdown string, NotoSansSC will automatically be used as the Chinese font (downloaded via googlefont CDN). If you cannot access googlefont CDN or want to use Chinese fonts offline, you need to pass vfs font files through the offlineFonts configuration option ([vfs reference](https://pdfmake.github.io/docs/0.1/fonts/custom-fonts-client-side/vfs/)).

Since the vfs_font.js generated by pdfmake is in CommonJS format, which is inconvenient to use in modern ES6 projects, this repository provides NotoSansCJKsc.ts and 方正黑体简体.ts font files for use in the examples, [see example](https://github.com/xionkq/md-to-pdf/blob/main/examples/dev/src/App.vue).

```ts
const vfs = (await import('./NotoSansCJKsc')).default
await downloadPdf(markdown.value, 'example-cn.pdf', {
  offlineFonts: {
    vfs: vfs,
    fontDefinitions: {
      NotoSansCJKsc: {
        normal: 'NotoSansCJKsc-Regular.otf',
        bold: 'NotoSansCJKsc-Bold.otf',
        italics: 'NotoSansCJKsc-Regular.otf',
        bolditalics: 'NotoSansCJKsc-Bold.otf',
      },
    },
    defaultCjkFont: 'NotoSansCJKsc',
    disableNetworkFonts: true,
  },
})
```

## Roadmap
- ~~Custom fonts~~
- ~~Recognize inline styles~~

## Credits

Many tag and style implementations reference [html-to-pdfmake](https://github.com/Aymkdn/html-to-pdfmake)
